import{C as a,E as i,j as $,aq as p,m as N,v as E,ar as g,G as S,as as I,T as k,at as q,$ as x,g as J,e as V,bv as C,r as D,d as F}from"./index.24fc4341.js";import{a as T,i as f,u as G,f as K,d as M,o as Q}from"./NAMessage.33f9916c.js";import{v as W}from"./normalizeUtils.07b13eed.js";import"./GPMessage.2b5bae8d.js";var Y=Object.defineProperty,Z=Object.defineProperties,z=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,h=(e,r,s)=>r in e?Y(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,v=(e,r)=>{for(var s in r||(r={}))H.call(r,s)&&h(e,s,r[s]);if(_)for(var s of _(r))L.call(r,s)&&h(e,s,r[s]);return e},O=(e,r)=>Z(e,z(r));function A(e){return e.features.map(r=>{const s=J.fromJSON(e.spatialReference),n=g.fromJSON(r);return V(n.geometry).spatialReference=s,n})}function d(e){return C(e.features.map(r=>(D(r.geometry)&&(r.geometry.spatialReference=e.spatialReference),F(r.geometry))))}let t=class extends k{constructor(e){super(e),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}readFacilities(e){return d(e)}readPointBarriers(e,r){return d(r.barriers)}readPolylineBarriers(e){return d(e)}readPolygonBarriers(e){return d(e)}readIncidents(e,r){return A(r.saPolylines)}readServiceAreaPolygons(e,r){return A(r.saPolygons)}};a([i({type:[$]})],t.prototype,"facilities",void 0),a([p("facilities")],t.prototype,"readFacilities",null),a([i({type:[T]})],t.prototype,"messages",void 0),a([i({type:[$]})],t.prototype,"pointBarriers",void 0),a([p("pointBarriers",["barriers"])],t.prototype,"readPointBarriers",null),a([i({type:[N]})],t.prototype,"polylineBarriers",void 0),a([p("polylineBarriers")],t.prototype,"readPolylineBarriers",null),a([i({type:[E]})],t.prototype,"polygonBarriers",void 0),a([p("polygonBarriers")],t.prototype,"readPolygonBarriers",null),a([i({type:[g]})],t.prototype,"serviceAreaPolylines",void 0),a([p("serviceAreaPolylines",["saPolylines"])],t.prototype,"readIncidents",null),a([i({type:[g]})],t.prototype,"serviceAreaPolygons",void 0),a([p("serviceAreaPolygons",["saPolygons"])],t.prototype,"readServiceAreaPolygons",null),t=a([S("esri.rest.support.ServiceAreaSolveResult")],t);const U=t,X=Q({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,defaultBreaks:!0,facilities:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},travelMode:!0});async function rr(e,r,s){const n=[],u=[],l={},c={},B=q(e),{path:P}=B;r.facilities&&r.facilities.features&&f(r.facilities.features,u,"facilities.features",l),r.pointBarriers&&r.pointBarriers.features&&f(r.pointBarriers.features,u,"pointBarriers.features",l),r.polylineBarriers&&r.polylineBarriers.features&&f(r.polylineBarriers.features,u,"polylineBarriers.features",l),r.polygonBarriers&&r.polygonBarriers.features&&f(r.polygonBarriers.features,u,"polygonBarriers.features",l);const b=await W(u);for(const o in l){const y=l[o];n.push(o),c[o]=b.slice(y[0],y[1])}if(G(c,n)){let o=null;try{o=await K(P,r.apiKey,s)}catch{}o&&!o.hasZ&&M(c,n)}for(const o in c)c[o].forEach((y,R)=>{r.get(o)[R].geometry=y});const w=O(v({},s),{query:O(v(v({},B.query),X.toQueryParams(r)),{f:"json"})}),{data:j}=await x(`${P}/solveServiceArea`,w);return U.fromJSON(j)}let m=class extends I{constructor(e){super(e),this.url=null}solve(e,r){return rr(this.url,e,r)}};a([i()],m.prototype,"url",void 0),m=a([S("esri.tasks.ServiceAreaTask")],m);const or=m;export{or as default};
